<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

    <!-- Keep native Odoo receipt layout; append FE block only. -->
    <t t-inherit="point_of_sale.OrderReceipt" t-inherit-mode="extension">
        <xpath expr="//div[contains(@class, 'pos-receipt')]" position="inside">
            <t t-set="data" t-value="(props &amp;&amp; (props.data || props.receipt || props.order_receipt || props.orderReceipt || props)) || {}"/>
            <t t-set="einvoice" t-value="(data &amp;&amp; data.einvoice) || {}"/>

            <div class="cr-fe-extra">
                <div class="cr-divider"/>

                <div class="cr-center cr-doc-type">
                    <t t-set="dtype" t-value="einvoice.document_type || ''"/>
                    <t t-if="dtype == 'te'">Tiquete electrónico</t>
                    <t t-elif="dtype == 'fe'">Factura electrónica</t>
                    <t t-elif="dtype == 'nc'">Nota de crédito electrónica</t>
                    <t t-else="">Comprobante</t>
                </div>

                <t t-set="consec" t-value="einvoice.consecutivo || ''"/>
                <t t-if="consec">
                    <div class="cr-center cr-small">Consecutivo: <t t-esc="consec"/></div>
                </t>

                <div class="cr-block">
                    <div class="cr-title">Clave</div>
                    <t t-set="clave" t-value="einvoice.clave || ''"/>
                    <t t-if="clave">
                        <div class="cr-mono cr-wrap"><t t-esc="clave"/></div>
                    </t>
                    <t t-else="">
                        <div class="cr-small">Pendiente</div>
                    </t>
                </div>

                <div class="cr-center cr-small">
                    <t t-set="status" t-value="einvoice.status || 'pending'"/>
                    Estado FE:
                    <t t-if="status == 'accepted'">Aceptado</t>
                    <t t-elif="status == 'rejected'">Rechazado</t>
                    <t t-elif="status == 'processing'">Procesando</t>
                    <t t-elif="status == 'sent'">Enviado</t>
                    <t t-else="">Pendiente</t>
                </div>
            </div>
        </xpath>
    </t>

</templates>
